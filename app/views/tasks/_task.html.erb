<tr>
	<td></td>
	<td><%= task.title %></td>
	<% if completed %>
	<td><%= Date.parse(task.finish_date).strftime('%d-%b-%Y') if task.finish_date %></td>
	<td>
	<%= link_to '<span class="ui-icon ui-icon-circle-check"></span>'.html_safe, "/tasks/#{task.id}?user_id=#{@user.id}&do=undo", method: :put, class: 'fg-button ui-state-default fg-button-icon-solo ui-corner-all ui-priority-primary',  title: "Unmark Complete" %>
	<%= link_to '<span class="ui-icon ui-icon-trash"></span>'.html_safe, "/tasks/#{task.id}?user_id=#{@user.id}", confirm: 'Are you sure?', method: :delete, class: "fg-button ui-state-default fg-button-icon-solo ui-corner-all ui-priority-secondary",  title: "Destroy" %></td>
<% else %>
<% due = Date.parse(task.due_date) %>
<% if due < Date.today %>
<td class="overdue"><%= due.strftime('%d-%b-%Y') %></td>
<% elsif due == Date.today %>
<td><%= "Today  (#{due.strftime('%d-%b-%Y')})" %>
<% else %>
<td><%= "#{distance_of_time_in_words_to_now(Date.parse(task.due_date))} (#{due.strftime('%d-%b-%Y')})" %></td>
<% end %>
	<td>
	<div class="fg-buttonset fg-buttonset-multi">
	<%= link_to '<span class="ui-icon ui-icon-check"></span>'.html_safe, "/tasks/#{task.id}?user_id=#{@user.id}&do=done", method: :put, class: 'fg-button ui-state-default fg-button-icon-solo ui-corner-all ui-priority-primary',  title: "Mark Complete" %>
	<%= link_to('<span class="ui-icon ui-icon-arrowthick-1-n"></span>'.html_safe, "/tasks/#{task.id}?user_id=#{@user.id}&do=up&pivot=#{prev.id}", method: :put, class: 'fg-button ui-state-default fg-button-icon-solo ui-corner-all ui-priority-secondary',  title: "Move Up") if prev %>
	<%= link_to('<span class="ui-icon ui-icon-arrowthick-1-s"></span>'.html_safe, "/tasks/#{task.id}?user_id=#{@user.id}&do=down&pivot=#{after.id}", method: :put, class: 'fg-button ui-state-default fg-button-icon-solo ui-corner-all ui-priority-secondary',  title: "Move Down") if after %>
	</div>
	</td>
<% end %>
</tr>